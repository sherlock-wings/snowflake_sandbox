USE ROLE USERADMIN;

---
--- NAMED_DATABASE Environment
---
 
  -- Schema-based ARs
    -- Read access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR TO ROLE SHERLOCKWINGS_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE SHERLOCKWINGS_EDW_DB TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT USAGE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_R_AR;



    -- Read-write access role

USE ROLE USERADMIN;

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR TO ROLE SHERLOCKWINGS_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE SHERLOCKWINGS_EDW_DB TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT USAGE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE TABLE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE VIEW ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE STAGE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE STREAM ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT CREATE TASK ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;


-- Table access
GRANT CREATE TABLE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_RW_AR;





    -- Full Access Role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR TO ROLE SHERLOCKWINGS_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE SHERLOCKWINGS_EDW_DB TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT USAGE ON SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA SHERLOCKWINGS_EDW_DB.UTIL TO ROLE SHERLOCKWINGS_EDW_DB_UTIL_FULL_AR;




-- NAMED_DATABASE Warehouses
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SHERLOCKWINGS_COMPUTE_WH_O_AR;
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE SHERLOCKWINGS_COMPUTE_WH TO ROLE SHERLOCKWINGS_COMPUTE_WH_O_AR;
GRANT ROLE SHERLOCKWINGS_COMPUTE_WH_O_AR TO ROLE SHERLOCKWINGS_SYSADMIN;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SHERLOCKWINGS_COMPUTE_WH_UW_AR;
GRANT ROLE SHERLOCKWINGS_COMPUTE_WH_UW_AR TO ROLE SHERLOCKWINGS_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE SHERLOCKWINGS_COMPUTE_WH TO ROLE SHERLOCKWINGS_COMPUTE_WH_UW_AR;
GRANT MONITOR ON WAREHOUSE SHERLOCKWINGS_COMPUTE_WH TO ROLE SHERLOCKWINGS_COMPUTE_WH_UW_AR;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SHERLOCKWINGS_COMPUTE_WH_U_AR;
GRANT ROLE SHERLOCKWINGS_COMPUTE_WH_U_AR TO ROLE SHERLOCKWINGS_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE SHERLOCKWINGS_COMPUTE_WH TO ROLE SHERLOCKWINGS_COMPUTE_WH_U_AR;



-- NAMED_DATABASE Functional Roles
grant role sherlockwings_edw_db_util_rw_ar   to role sherlockwings_engineer_fr;
grant role sherlockwings_compute_wh_uw_ar    to role sherlockwings_engineer_fr;
grant role sherlockwings_edw_db_util_full_ar to role sherlockwings_admin_fr;
grant role sherlockwings_compute_wh_o_ar     to role sherlockwings_admin_fr;








---
--- SANDBOX Environment
---
USE ROLE USERADMIN;
  -- Schema-based ARs
    -- Read access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS SANDBOX_EDW_DB_R_AR;
GRANT ROLE SANDBOX_EDW_DB_R_AR TO ROLE SANDBOX_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE SANDBOX_EDW_DB TO ROLE SANDBOX_EDW_DB_R_AR;

-- No privs granted to access roles at schema level, except when done by the clone-sproc


    -- Read-write access role

USE ROLE USERADMIN;

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS SANDBOX_EDW_DB_RW_AR;
GRANT ROLE SANDBOX_EDW_DB_RW_AR TO ROLE SANDBOX_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE SANDBOX_EDW_DB TO ROLE SANDBOX_EDW_DB_RW_AR;

-- No privs granted to access roles at schema level, except when done by the clone-sproc



    -- Full Access Role
    
USE ROLE USERADMIN;
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS SANDBOX_EDW_DB_FULL_AR;
GRANT ROLE SANDBOX_EDW_DB_FULL_AR TO ROLE SANDBOX_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE SANDBOX_EDW_DB TO ROLE SANDBOX_EDW_DB_FULL_AR;

-- No privs granted to access roles at schema level, except when done by the clone-sproc


-- SANDBOX Warehouses
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SANDBOX_COMPUTE_WH_O_AR;
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE SANDBOX_COMPUTE_WH TO ROLE SANDBOX_COMPUTE_WH_O_AR;
GRANT ROLE SANDBOX_COMPUTE_WH_O_AR TO ROLE SANDBOX_SYSADMIN;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SANDBOX_COMPUTE_WH_UW_AR;
GRANT ROLE SANDBOX_COMPUTE_WH_UW_AR TO ROLE SANDBOX_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE SANDBOX_COMPUTE_WH TO ROLE SANDBOX_COMPUTE_WH_UW_AR;
GRANT MONITOR ON WAREHOUSE SANDBOX_COMPUTE_WH TO ROLE SANDBOX_COMPUTE_WH_UW_AR;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SANDBOX_COMPUTE_WH_U_AR;
GRANT ROLE SANDBOX_COMPUTE_WH_U_AR TO ROLE SANDBOX_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE SANDBOX_COMPUTE_WH TO ROLE SANDBOX_COMPUTE_WH_U_AR;


-- SANDBOX Functional Roles
grant role SANDBOX_edw_db_rw_ar      to role SANDBOX_engineer_fr;
grant role SANDBOX_compute_wh_uw_ar  to role SANDBOX_engineer_fr;
grant role SANDBOX_edw_db_full_ar    to role SANDBOX_admin_fr;
grant role SANDBOX_compute_wh_o_ar   to role SANDBOX_admin_fr;













---
--- DEV Environment
---
USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_RAW_R_AR;
GRANT ROLE DEV_EDW_DB_RAW_R_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_RAW_RW_AR;
GRANT ROLE DEV_EDW_DB_RAW_RW_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE TABLE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE VIEW ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE STAGE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE STREAM ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT CREATE TASK ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_RAW_FULL_AR;
GRANT ROLE DEV_EDW_DB_RAW_FULL_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.RAW TO ROLE DEV_EDW_DB_RAW_FULL_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_STAGE_R_AR;
GRANT ROLE DEV_EDW_DB_STAGE_R_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_STAGE_RW_AR;
GRANT ROLE DEV_EDW_DB_STAGE_RW_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE TABLE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE VIEW ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE STAGE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE STREAM ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT CREATE TASK ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_STAGE_FULL_AR;
GRANT ROLE DEV_EDW_DB_STAGE_FULL_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;


-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.STAGE TO ROLE DEV_EDW_DB_STAGE_FULL_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_MODEL_R_AR;
GRANT ROLE DEV_EDW_DB_MODEL_R_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_MODEL_RW_AR;
GRANT ROLE DEV_EDW_DB_MODEL_RW_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE TABLE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE VIEW ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE MODEL ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE STREAM ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT CREATE TASK ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS DEV_EDW_DB_MODEL_FULL_AR;
GRANT ROLE DEV_EDW_DB_MODEL_FULL_AR TO ROLE DEV_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE DEV_EDW_DB TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA DEV_EDW_DB.MODEL TO ROLE DEV_EDW_DB_MODEL_FULL_AR;





-- DEV Warehouses
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS DEV_COMPUTE_WH_O_AR;
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE DEV_COMPUTE_WH TO ROLE DEV_COMPUTE_WH_O_AR;
GRANT ROLE DEV_COMPUTE_WH_O_AR TO ROLE DEV_SYSADMIN;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS DEV_COMPUTE_WH_UW_AR;
GRANT ROLE DEV_COMPUTE_WH_UW_AR TO ROLE DEV_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE DEV_COMPUTE_WH TO ROLE DEV_COMPUTE_WH_UW_AR;
GRANT MONITOR ON WAREHOUSE DEV_COMPUTE_WH TO ROLE DEV_COMPUTE_WH_UW_AR;


USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS DEV_COMPUTE_WH_U_AR;
GRANT ROLE DEV_COMPUTE_WH_U_AR TO ROLE DEV_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE DEV_COMPUTE_WH TO ROLE DEV_COMPUTE_WH_U_AR;







-- DEV Functional Roles
grant role dev_edw_db_raw_r_ar      to role dev_analyst_fr;
grant role dev_edw_db_stage_r_ar    to role dev_analyst_fr;
grant role dev_edw_db_model_r_ar    to role dev_analyst_fr;

grant role dev_edw_db_raw_rw_ar     to role dev_engineer_fr;
grant role dev_edw_db_stage_rw_ar   to role dev_engineer_fr;
grant role dev_edw_db_model_rw_ar   to role dev_engineer_fr;

grant role dev_edw_db_raw_rw_ar     to role dev_svctransform_fr;
grant role dev_edw_db_stage_rw_ar   to role dev_svctransform_fr;
grant role dev_edw_db_model_rw_ar   to role dev_svctransform_fr;

grant role dev_edw_db_raw_full_ar   to role dev_admin_fr;
grant role dev_edw_db_stage_full_ar to role dev_admin_fr;
grant role dev_edw_db_model_full_ar to role dev_admin_fr;


-- Readups for UTIL and SANDBOX engineers
grant role dev_edw_db_raw_r_ar   to role sherlockwings_engineer_fr;
grant role dev_edw_db_stage_r_ar to role sherlockwings_engineer_fr;
grant role dev_edw_db_model_r_ar to role sherlockwings_engineer_fr;

grant role dev_edw_db_raw_r_ar   to role sandbox_engineer_fr;
grant role dev_edw_db_stage_r_ar to role sandbox_engineer_fr;
grant role dev_edw_db_model_r_ar to role sandbox_engineer_fr;









---
--- QA Environment
---
USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_RAW_R_AR;
GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_RAW_RW_AR;
GRANT ROLE QA_EDW_DB_RAW_RW_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE TABLE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE VIEW ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE STAGE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE STREAM ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT CREATE TASK ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_RAW_FULL_AR;
GRANT ROLE QA_EDW_DB_RAW_FULL_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.RAW TO ROLE QA_EDW_DB_RAW_FULL_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_STAGE_R_AR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_STAGE_RW_AR;
GRANT ROLE QA_EDW_DB_STAGE_RW_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE TABLE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE VIEW ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE STAGE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE STREAM ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT CREATE TASK ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_STAGE_FULL_AR;
GRANT ROLE QA_EDW_DB_STAGE_FULL_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;


-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.STAGE TO ROLE QA_EDW_DB_STAGE_FULL_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_MODEL_R_AR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_MODEL_RW_AR;
GRANT ROLE QA_EDW_DB_MODEL_RW_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE TABLE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE VIEW ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE MODEL ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE STREAM ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT CREATE TASK ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS QA_EDW_DB_MODEL_FULL_AR;
GRANT ROLE QA_EDW_DB_MODEL_FULL_AR TO ROLE QA_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE QA_EDW_DB TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA QA_EDW_DB.MODEL TO ROLE QA_EDW_DB_MODEL_FULL_AR;





-- QA Warehouses
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS QA_COMPUTE_WH_O_AR;
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE QA_COMPUTE_WH TO ROLE QA_COMPUTE_WH_O_AR;
GRANT ROLE QA_COMPUTE_WH_O_AR TO ROLE QA_SYSADMIN;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS QA_COMPUTE_WH_UW_AR;
GRANT ROLE QA_COMPUTE_WH_UW_AR TO ROLE QA_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE QA_COMPUTE_WH TO ROLE QA_COMPUTE_WH_UW_AR;
GRANT MONITOR ON WAREHOUSE QA_COMPUTE_WH TO ROLE QA_COMPUTE_WH_UW_AR;


USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS QA_COMPUTE_WH_U_AR;
GRANT ROLE QA_COMPUTE_WH_U_AR TO ROLE QA_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE QA_COMPUTE_WH TO ROLE QA_COMPUTE_WH_U_AR;







-- QA Functional Roles
grant role QA_edw_db_raw_r_ar      to role QA_analyst_fr;
grant role QA_edw_db_stage_r_ar    to role QA_analyst_fr;
grant role QA_edw_db_model_r_ar    to role QA_analyst_fr;

grant role QA_edw_db_raw_rw_ar     to role QA_engineer_fr;
grant role QA_edw_db_stage_rw_ar   to role QA_engineer_fr;
grant role QA_edw_db_model_rw_ar   to role QA_engineer_fr;

grant role QA_edw_db_raw_rw_ar     to role QA_svctransform_fr;
grant role QA_edw_db_stage_rw_ar   to role QA_svctransform_fr;
grant role QA_edw_db_model_rw_ar   to role QA_svctransform_fr;

grant role QA_edw_db_raw_full_ar   to role QA_admin_fr;
grant role QA_edw_db_stage_full_ar to role QA_admin_fr;
grant role QA_edw_db_model_full_ar to role QA_admin_fr;


-- Readups for UTIL and SANDBOX engineers
grant role qa_edw_db_raw_r_ar   to role sherlockwings_engineer_fr;
grant role qa_edw_db_stage_r_ar to role sherlockwings_engineer_fr;
grant role qa_edw_db_model_r_ar to role sherlockwings_engineer_fr;

grant role qa_edw_db_raw_r_ar   to role sandbox_engineer_fr;
grant role qa_edw_db_stage_r_ar to role sandbox_engineer_fr;
grant role qa_edw_db_model_r_ar to role sandbox_engineer_fr;

grant role qa_edw_db_raw_r_ar   to role dev_engineer_fr;
grant role qa_edw_db_stage_r_ar to role dev_engineer_fr;
grant role qa_edw_db_model_r_ar to role dev_engineer_fr;










---
--- PROD Environment
---
USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_RAW_R_AR;
GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_RAW_RW_AR;
GRANT ROLE PROD_EDW_DB_RAW_RW_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE TABLE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE VIEW ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE STAGE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE STREAM ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT CREATE TASK ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- RAW schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_RAW_FULL_AR;
GRANT ROLE PROD_EDW_DB_RAW_FULL_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.RAW TO ROLE PROD_EDW_DB_RAW_FULL_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_STAGE_R_AR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_STAGE_RW_AR;
GRANT ROLE PROD_EDW_DB_STAGE_RW_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE TABLE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE VIEW ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE STAGE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE STREAM ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT CREATE TASK ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- STAGE schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_STAGE_FULL_AR;
GRANT ROLE PROD_EDW_DB_STAGE_FULL_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;


-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.STAGE TO ROLE PROD_EDW_DB_STAGE_FULL_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Read access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_MODEL_R_AR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- Table access
GRANT SELECT ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_R_AR;




USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Read-Write access role
        
-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_MODEL_RW_AR;
GRANT ROLE PROD_EDW_DB_MODEL_RW_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE TABLE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE VIEW ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- No privs to run this on my bozo free account!  ( ﾟ，_ゝ｀)
-- GRANT CREATE MATERIALIZED VIEW ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

GRANT CREATE SEQUENCE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE MODEL ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE FILE FORMAT ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE STREAM ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE PROCEDURE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE FUNCTION ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT CREATE TASK ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;



-- Table access
GRANT CREATE TABLE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- View access
GRANT SELECT ON ALL VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- Sequence access
GRANT USAGE ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- Stage access
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;


-- File format access
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- Stream access
GRANT SELECT ON ALL STREAMS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- Sproc access
GRANT USAGE ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- UDF access
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- Materialized view access
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;

-- Task Access
GRANT MONITOR ON ALL TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_RW_AR;





USE ROLE USERADMIN;
  -- Schema-based ARs
    -- MODEL schema
        -- Full-access access role

-- Instantiate role and the environment SYSADMIN's inheritance of it
CREATE ROLE IF NOT EXISTS PROD_EDW_DB_MODEL_FULL_AR;
GRANT ROLE PROD_EDW_DB_MODEL_FULL_AR TO ROLE PROD_SYSADMIN;

USE ROLE SECURITYADMIN;

-- Schema access
GRANT USAGE ON DATABASE PROD_EDW_DB TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- Table access
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT INSERT ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT UPDATE ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT DELETE ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT REFERENCES ON ALL TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT INSERT ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT UPDATE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT DELETE ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;


-- View access
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;


-- Sequence access
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- Stage access
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT USAGE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT READ ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT READ ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT WRITE ON ALL STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT WRITE ON FUTURE STAGES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- File format access
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- Stream access
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- Sproc access
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- UDF Access
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;

-- Task access
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON ALL TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON ALL TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT MONITOR ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;
GRANT OPERATE ON FUTURE TASKS IN SCHEMA PROD_EDW_DB.MODEL TO ROLE PROD_EDW_DB_MODEL_FULL_AR;





-- PROD Warehouses
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS PROD_COMPUTE_WH_O_AR;
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE PROD_COMPUTE_WH TO ROLE PROD_COMPUTE_WH_O_AR;
GRANT ROLE PROD_COMPUTE_WH_O_AR TO ROLE PROD_SYSADMIN;

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS PROD_COMPUTE_WH_UW_AR;
GRANT ROLE PROD_COMPUTE_WH_UW_AR TO ROLE PROD_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE PROD_COMPUTE_WH TO ROLE PROD_COMPUTE_WH_UW_AR;
GRANT MONITOR ON WAREHOUSE PROD_COMPUTE_WH TO ROLE PROD_COMPUTE_WH_UW_AR;


USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS PROD_COMPUTE_WH_U_AR;
GRANT ROLE PROD_COMPUTE_WH_U_AR TO ROLE PROD_SYSADMIN;
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE PROD_COMPUTE_WH TO ROLE PROD_COMPUTE_WH_U_AR;







-- PROD Functional Roles
grant role PROD_edw_db_raw_r_ar      to role PROD_analyst_fr;
grant role PROD_edw_db_stage_r_ar    to role PROD_analyst_fr;
grant role PROD_edw_db_model_r_ar    to role PROD_analyst_fr;

grant role PROD_edw_db_raw_rw_ar     to role PROD_svctransform_fr;
grant role PROD_edw_db_stage_rw_ar   to role PROD_svctransform_fr;
grant role PROD_edw_db_model_rw_ar   to role PROD_svctransform_fr;


-- Readups for UTIL and SANDBOX engineers
grant role PROD_edw_db_raw_r_ar   to role sherlockwings_engineer_fr;
grant role PROD_edw_db_stage_r_ar to role sherlockwings_engineer_fr;
grant role PROD_edw_db_model_r_ar to role sherlockwings_engineer_fr;

grant role PROD_edw_db_raw_r_ar   to role sandbox_engineer_fr;
grant role PROD_edw_db_stage_r_ar to role sandbox_engineer_fr;
grant role PROD_edw_db_model_r_ar to role sandbox_engineer_fr;

grant role PROD_edw_db_raw_r_ar   to role dev_engineer_fr;
grant role PROD_edw_db_stage_r_ar to role dev_engineer_fr;
grant role PROD_edw_db_model_r_ar to role dev_engineer_fr;

grant role prod_edw_db_raw_r_ar   to role qa_engineer_fr;
grant role prod_edw_db_stage_r_ar to role qa_engineer_fr;
grant role prod_edw_db_model_r_ar to role qa_engineer_fr;
