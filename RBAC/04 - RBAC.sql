/*

BEGIN ROLEOUT-GENERATED RBAC

*/

--
-- DEV Environment
--

-- Create MODEL owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "DEV_EDW_DB_MODEL_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create RAW owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "DEV_EDW_DB_RAW_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create STAGE owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "DEV_EDW_DB_STAGE_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create DEV_COMPUTE_WH owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_FULL_AR";
GRANT ROLE "DEV_COMPUTE_WH_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_MODEL_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_R_AR";
GRANT ROLE "DEV_EDW_DB_MODEL_R_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_MODEL_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_RW_AR";
GRANT ROLE "DEV_EDW_DB_MODEL_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_MODEL_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_FULL_AR";
GRANT ROLE "DEV_EDW_DB_MODEL_FULL_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_RAW_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_R_AR";
GRANT ROLE "DEV_EDW_DB_RAW_R_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_RAW_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_RW_AR";
GRANT ROLE "DEV_EDW_DB_RAW_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_RAW_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_FULL_AR";
GRANT ROLE "DEV_EDW_DB_RAW_FULL_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_STAGE_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_R_AR";
GRANT ROLE "DEV_EDW_DB_STAGE_R_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_STAGE_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_RW_AR";
GRANT ROLE "DEV_EDW_DB_STAGE_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_STAGE_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_FULL_AR";
GRANT ROLE "DEV_EDW_DB_STAGE_FULL_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";

-- Create and Grant Privileges to Access Role DEV_COMPUTE_WH_U_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_COMPUTE_WH_U_AR";
GRANT ROLE "DEV_COMPUTE_WH_U_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_U_AR";

-- Create and Grant Privileges to Access Role DEV_COMPUTE_WH_UM_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_COMPUTE_WH_UM_AR";
GRANT ROLE "DEV_COMPUTE_WH_UM_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_UM_AR";
GRANT MONITOR ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_UM_AR";

-- Grant Access Roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE "DEV_EDW_DB_MODEL_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_EDW_DB_RAW_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_EDW_DB_STAGE_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_COMPUTE_WH_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_EDW_DB_MODEL_R_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_EDW_DB_RAW_R_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_EDW_DB_STAGE_R_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_COMPUTE_WH_U_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_EDW_DB_MODEL_RW_AR" TO ROLE "DEV_ENGINEER_FR";
GRANT ROLE "DEV_EDW_DB_RAW_RW_AR" TO ROLE "DEV_ENGINEER_FR";
GRANT ROLE "DEV_EDW_DB_STAGE_RW_AR" TO ROLE "DEV_ENGINEER_FR";
GRANT ROLE "DEV_COMPUTE_WH_UM_AR" TO ROLE "DEV_ENGINEER_FR";

--
-- PROD Environment
--

-- Create MODEL owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "PROD_EDW_DB_MODEL_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create RAW owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "PROD_EDW_DB_RAW_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create STAGE owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "PROD_EDW_DB_STAGE_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create PROD_COMPUTE_WH owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_FULL_AR";
GRANT ROLE "PROD_COMPUTE_WH_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_MODEL_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_R_AR";
GRANT ROLE "PROD_EDW_DB_MODEL_R_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_MODEL_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_RW_AR";
GRANT ROLE "PROD_EDW_DB_MODEL_RW_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_MODEL_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_FULL_AR";
GRANT ROLE "PROD_EDW_DB_MODEL_FULL_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_RAW_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_R_AR";
GRANT ROLE "PROD_EDW_DB_RAW_R_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_RAW_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_RW_AR";
GRANT ROLE "PROD_EDW_DB_RAW_RW_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_RAW_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_FULL_AR";
GRANT ROLE "PROD_EDW_DB_RAW_FULL_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_STAGE_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_R_AR";
GRANT ROLE "PROD_EDW_DB_STAGE_R_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_STAGE_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_RW_AR";
GRANT ROLE "PROD_EDW_DB_STAGE_RW_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_STAGE_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_FULL_AR";
GRANT ROLE "PROD_EDW_DB_STAGE_FULL_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";

-- Create and Grant Privileges to Access Role PROD_COMPUTE_WH_U_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_COMPUTE_WH_U_AR";
GRANT ROLE "PROD_COMPUTE_WH_U_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_U_AR";

-- Create and Grant Privileges to Access Role PROD_COMPUTE_WH_UM_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_COMPUTE_WH_UM_AR";
GRANT ROLE "PROD_COMPUTE_WH_UM_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_UM_AR";
GRANT MONITOR ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_UM_AR";

-- Grant Access Roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE "PROD_EDW_DB_MODEL_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_EDW_DB_RAW_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_EDW_DB_STAGE_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_COMPUTE_WH_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_EDW_DB_MODEL_R_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_EDW_DB_RAW_R_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_EDW_DB_STAGE_R_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_COMPUTE_WH_U_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_EDW_DB_MODEL_RW_AR" TO ROLE "PROD_ENGINEER_FR";
GRANT ROLE "PROD_EDW_DB_RAW_RW_AR" TO ROLE "PROD_ENGINEER_FR";
GRANT ROLE "PROD_EDW_DB_STAGE_RW_AR" TO ROLE "PROD_ENGINEER_FR";
GRANT ROLE "PROD_COMPUTE_WH_UM_AR" TO ROLE "PROD_ENGINEER_FR";

--
-- QA Environment
--

-- Create MODEL owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "QA_EDW_DB_MODEL_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create RAW owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "QA_EDW_DB_RAW_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create STAGE owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "QA_EDW_DB_STAGE_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create QA_COMPUTE_WH owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_FULL_AR";
GRANT ROLE "QA_COMPUTE_WH_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create and Grant Privileges to Access Role QA_EDW_DB_MODEL_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_R_AR";
GRANT ROLE "QA_EDW_DB_MODEL_R_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_MODEL_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_RW_AR";
GRANT ROLE "QA_EDW_DB_MODEL_RW_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_MODEL_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_FULL_AR";
GRANT ROLE "QA_EDW_DB_MODEL_FULL_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_RAW_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_R_AR";
GRANT ROLE "QA_EDW_DB_RAW_R_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_RAW_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_RW_AR";
GRANT ROLE "QA_EDW_DB_RAW_RW_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_RAW_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_FULL_AR";
GRANT ROLE "QA_EDW_DB_RAW_FULL_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_STAGE_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_R_AR";
GRANT ROLE "QA_EDW_DB_STAGE_R_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_STAGE_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_RW_AR";
GRANT ROLE "QA_EDW_DB_STAGE_RW_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_STAGE_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_FULL_AR";
GRANT ROLE "QA_EDW_DB_STAGE_FULL_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";

-- Create and Grant Privileges to Access Role QA_COMPUTE_WH_U_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_COMPUTE_WH_U_AR";
GRANT ROLE "QA_COMPUTE_WH_U_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_U_AR";

-- Create and Grant Privileges to Access Role QA_COMPUTE_WH_UM_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_COMPUTE_WH_UM_AR";
GRANT ROLE "QA_COMPUTE_WH_UM_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_UM_AR";
GRANT MONITOR ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_UM_AR";

-- Grant Access Roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE "QA_EDW_DB_MODEL_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_EDW_DB_RAW_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_EDW_DB_STAGE_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_COMPUTE_WH_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_EDW_DB_MODEL_R_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_EDW_DB_RAW_R_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_EDW_DB_STAGE_R_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_COMPUTE_WH_U_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_EDW_DB_MODEL_RW_AR" TO ROLE "QA_ENGINEER_FR";
GRANT ROLE "QA_EDW_DB_RAW_RW_AR" TO ROLE "QA_ENGINEER_FR";
GRANT ROLE "QA_EDW_DB_STAGE_RW_AR" TO ROLE "QA_ENGINEER_FR";
GRANT ROLE "QA_COMPUTE_WH_UM_AR" TO ROLE "QA_ENGINEER_FR";


/*

END ROLEOUT-GENERATED RBAC

*/


/*

BEGIN CUSTOM RBAC

*/

/*

Need to add Sandbox Objects and Roles

These rights will be at the Database level, and no "native" schema will exist in 
the Sandbox. What schema do exist in the Sandbox will (usually) be created with the
Clone-to-Sandbox sproc, and RBAC for those newly-created schemas is generated on-the-fly
within that sproc itself.

*/

-- Create and Grant Privileges to Access Role SANDBOX_EDW_DB_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "SANDBOX_EDW_DB_FULL_AR";
GRANT ROLE "SANDBOX_EDW_DB_FULL_AR" TO ROLE "SANDBOX_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT READ ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT READ ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT INSERT ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT UPDATE ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT DELETE ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT WRITE ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT MONITOR ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OPERATE ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";




-- Create and Grant Privileges to Access Role SANDBOX_EDW_DB_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "SANDBOX_EDW_DB_RW_AR";
GRANT ROLE "SANDBOX_EDW_DB_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON ALL VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT READ ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT READ ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON ALL STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT INSERT ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT UPDATE ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT DELETE ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT REFERENCES ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT INSERT ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT DELETE ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT WRITE ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT WRITE ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT MONITOR ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT OPERATE ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_RW_AR";

-- Apply Access roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE SANDBOX_EDW_DB_RW_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE SANDBOX_EDW_DB_FULL_AR TO ROLE SANDBOX_ADMIN_FR;
/*

Roleout's Default behavior is to isolate each of the envs-- as in the QA roles can't interact at all with the Dev objects, 
the Dev roles can't at all interact with the Prod objects, etc.

This is not usually what we want in practice. Instead, we want to support "read-ups". That is, for any given environment,
the roles for that Env should have read-only access to the higher envs, their entitled access to the role's dedicated
env, and no access to lower envs.

For example, the DEV_ENGINEER_FR role should have

1. Zero access to Sandbox
2. Read/write access to Dev
3. Read-only access to QA
4. Read-only access to Prod

*/

USE ROLE SECURITYADMIN;

-- Allow "read ups" from Dev Analyst, Engineer, Admin to QA
GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE DEV_ANALYST_FR;

GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE DEV_ENGINEER_FR;

GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE DEV_ADMIN_FR;


-- Allow "read ups" from Dev Analyst, Engineer, Admin to Prod
GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE DEV_ANALYST_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE DEV_ENGINEER_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE DEV_ADMIN_FR;


-- Allow "read ups" from QA Analyst, Engineer, Admin to Prod
GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE QA_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE QA_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE QA_ANALYST_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE QA_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE QA_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE QA_ENGINEER_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE QA_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE QA_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE QA_ADMIN_FR;
