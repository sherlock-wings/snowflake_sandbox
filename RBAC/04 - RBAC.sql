/*

RBAC SECTION 1: DEV, QA, & PROD

Includes:
I)   The definitions of the read, Read-Write, and Full Access Roles for Dev, QA, and Prod
II)  The grants that coalesce all these various access roles into Functional Roles

This section is almost entirely generated by Roleout. The only exceptions for this are
specific grants/SQL statements that will be identified with in-line comments. 

*/

--
-- DEV Environment
--

-- Create MODEL owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "DEV_EDW_DB_MODEL_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create RAW owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "DEV_EDW_DB_RAW_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create STAGE owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "DEV_EDW_DB_STAGE_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create DEV_COMPUTE_WH owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_FULL_AR";
GRANT ROLE "DEV_COMPUTE_WH_FULL_AR" TO ROLE "DEV_SYSADMIN";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_MODEL_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_R_AR";
GRANT ROLE "DEV_EDW_DB_MODEL_R_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_R_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_MODEL_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_RW_AR";
GRANT ROLE "DEV_EDW_DB_MODEL_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_RW_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_MODEL_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_MODEL_FULL_AR";
GRANT ROLE "DEV_EDW_DB_MODEL_FULL_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."MODEL" TO ROLE "DEV_EDW_DB_MODEL_FULL_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_RAW_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_R_AR";
GRANT ROLE "DEV_EDW_DB_RAW_R_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_R_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_RAW_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_RW_AR";
GRANT ROLE "DEV_EDW_DB_RAW_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_RW_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_RAW_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_RAW_FULL_AR";
GRANT ROLE "DEV_EDW_DB_RAW_FULL_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."RAW" TO ROLE "DEV_EDW_DB_RAW_FULL_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_STAGE_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_R_AR";
GRANT ROLE "DEV_EDW_DB_STAGE_R_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_R_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_STAGE_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_RW_AR";
GRANT ROLE "DEV_EDW_DB_STAGE_RW_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_RW_AR";

-- Create and Grant Privileges to Access Role DEV_EDW_DB_STAGE_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_EDW_DB_STAGE_FULL_AR";
GRANT ROLE "DEV_EDW_DB_STAGE_FULL_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON DATABASE "DEV_EDW_DB" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "DEV_EDW_DB"."STAGE" TO ROLE "DEV_EDW_DB_STAGE_FULL_AR";

-- Create and Grant Privileges to Access Role DEV_COMPUTE_WH_U_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_COMPUTE_WH_U_AR";
GRANT ROLE "DEV_COMPUTE_WH_U_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_U_AR";

-- Create and Grant Privileges to Access Role DEV_COMPUTE_WH_UM_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "DEV_COMPUTE_WH_UM_AR";
GRANT ROLE "DEV_COMPUTE_WH_UM_AR" TO ROLE "DEV_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_UM_AR";
GRANT MONITOR ON WAREHOUSE "DEV_COMPUTE_WH" TO ROLE "DEV_COMPUTE_WH_UM_AR";

-- Grant Access Roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE "DEV_EDW_DB_MODEL_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_EDW_DB_RAW_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_EDW_DB_STAGE_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_COMPUTE_WH_FULL_AR" TO ROLE "DEV_ADMIN_FR";
GRANT ROLE "DEV_EDW_DB_MODEL_R_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_EDW_DB_RAW_R_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_EDW_DB_STAGE_R_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_COMPUTE_WH_U_AR" TO ROLE "DEV_ANALYST_FR";
GRANT ROLE "DEV_EDW_DB_MODEL_RW_AR" TO ROLE "DEV_ENGINEER_FR";
GRANT ROLE "DEV_EDW_DB_RAW_RW_AR" TO ROLE "DEV_ENGINEER_FR";
GRANT ROLE "DEV_EDW_DB_STAGE_RW_AR" TO ROLE "DEV_ENGINEER_FR";
GRANT ROLE "DEV_COMPUTE_WH_UM_AR" TO ROLE "DEV_ENGINEER_FR";

-- One more add for SECURITYADMIN; this is necessary so this role can be used to run certain sprocs
grant role dev_compute_wh_full_ar to role securityadmin;


--
-- PROD Environment
--

-- Create MODEL owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "PROD_EDW_DB_MODEL_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create RAW owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "PROD_EDW_DB_RAW_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create STAGE owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "PROD_EDW_DB_STAGE_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create PROD_COMPUTE_WH owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_FULL_AR";
GRANT ROLE "PROD_COMPUTE_WH_FULL_AR" TO ROLE "PROD_SYSADMIN";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_MODEL_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_R_AR";
GRANT ROLE "PROD_EDW_DB_MODEL_R_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_R_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_MODEL_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_RW_AR";
GRANT ROLE "PROD_EDW_DB_MODEL_RW_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_RW_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_MODEL_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_MODEL_FULL_AR";
GRANT ROLE "PROD_EDW_DB_MODEL_FULL_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."MODEL" TO ROLE "PROD_EDW_DB_MODEL_FULL_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_RAW_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_R_AR";
GRANT ROLE "PROD_EDW_DB_RAW_R_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_R_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_RAW_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_RW_AR";
GRANT ROLE "PROD_EDW_DB_RAW_RW_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_RW_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_RAW_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_RAW_FULL_AR";
GRANT ROLE "PROD_EDW_DB_RAW_FULL_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."RAW" TO ROLE "PROD_EDW_DB_RAW_FULL_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_STAGE_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_R_AR";
GRANT ROLE "PROD_EDW_DB_STAGE_R_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_R_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_STAGE_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_RW_AR";
GRANT ROLE "PROD_EDW_DB_STAGE_RW_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_RW_AR";

-- Create and Grant Privileges to Access Role PROD_EDW_DB_STAGE_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_EDW_DB_STAGE_FULL_AR";
GRANT ROLE "PROD_EDW_DB_STAGE_FULL_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON DATABASE "PROD_EDW_DB" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "PROD_EDW_DB"."STAGE" TO ROLE "PROD_EDW_DB_STAGE_FULL_AR";

-- Create and Grant Privileges to Access Role PROD_COMPUTE_WH_U_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_COMPUTE_WH_U_AR";
GRANT ROLE "PROD_COMPUTE_WH_U_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_U_AR";

-- Create and Grant Privileges to Access Role PROD_COMPUTE_WH_UM_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "PROD_COMPUTE_WH_UM_AR";
GRANT ROLE "PROD_COMPUTE_WH_UM_AR" TO ROLE "PROD_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_UM_AR";
GRANT MONITOR ON WAREHOUSE "PROD_COMPUTE_WH" TO ROLE "PROD_COMPUTE_WH_UM_AR";

-- Grant Access Roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE "PROD_EDW_DB_MODEL_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_EDW_DB_RAW_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_EDW_DB_STAGE_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_COMPUTE_WH_FULL_AR" TO ROLE "PROD_ADMIN_FR";
GRANT ROLE "PROD_EDW_DB_MODEL_R_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_EDW_DB_RAW_R_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_EDW_DB_STAGE_R_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_COMPUTE_WH_U_AR" TO ROLE "PROD_ANALYST_FR";
GRANT ROLE "PROD_EDW_DB_MODEL_RW_AR" TO ROLE "PROD_ENGINEER_FR";
GRANT ROLE "PROD_EDW_DB_RAW_RW_AR" TO ROLE "PROD_ENGINEER_FR";
GRANT ROLE "PROD_EDW_DB_STAGE_RW_AR" TO ROLE "PROD_ENGINEER_FR";
GRANT ROLE "PROD_COMPUTE_WH_UM_AR" TO ROLE "PROD_ENGINEER_FR";

--
-- QA Environment
--

-- Create MODEL owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "QA_EDW_DB_MODEL_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create RAW owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "QA_EDW_DB_RAW_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create STAGE owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" REVOKE CURRENT GRANTS;
GRANT ROLE "QA_EDW_DB_STAGE_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create QA_COMPUTE_WH owner access role
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_FULL_AR";
GRANT ROLE "QA_COMPUTE_WH_FULL_AR" TO ROLE "QA_SYSADMIN";

-- Create and Grant Privileges to Access Role QA_EDW_DB_MODEL_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_R_AR";
GRANT ROLE "QA_EDW_DB_MODEL_R_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_R_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_MODEL_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_RW_AR";
GRANT ROLE "QA_EDW_DB_MODEL_RW_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_RW_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_MODEL_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_MODEL_FULL_AR";
GRANT ROLE "QA_EDW_DB_MODEL_FULL_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."MODEL" TO ROLE "QA_EDW_DB_MODEL_FULL_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_RAW_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_R_AR";
GRANT ROLE "QA_EDW_DB_RAW_R_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_R_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_RAW_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_RW_AR";
GRANT ROLE "QA_EDW_DB_RAW_RW_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_RW_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_RAW_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_RAW_FULL_AR";
GRANT ROLE "QA_EDW_DB_RAW_FULL_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."RAW" TO ROLE "QA_EDW_DB_RAW_FULL_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_STAGE_R_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_R_AR";
GRANT ROLE "QA_EDW_DB_STAGE_R_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_R_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_STAGE_RW_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_RW_AR";
GRANT ROLE "QA_EDW_DB_STAGE_RW_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_RW_AR";

-- Create and Grant Privileges to Access Role QA_EDW_DB_STAGE_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_EDW_DB_STAGE_FULL_AR";
GRANT ROLE "QA_EDW_DB_STAGE_FULL_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON DATABASE "QA_EDW_DB" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT READ ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT READ ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT WRITE ON ALL STAGES IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON ALL TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN SCHEMA "QA_EDW_DB"."STAGE" TO ROLE "QA_EDW_DB_STAGE_FULL_AR";

-- Create and Grant Privileges to Access Role QA_COMPUTE_WH_U_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_COMPUTE_WH_U_AR";
GRANT ROLE "QA_COMPUTE_WH_U_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_U_AR";

-- Create and Grant Privileges to Access Role QA_COMPUTE_WH_UM_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "QA_COMPUTE_WH_UM_AR";
GRANT ROLE "QA_COMPUTE_WH_UM_AR" TO ROLE "QA_SYSADMIN";
USE ROLE SECURITYADMIN;
GRANT USAGE ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_UM_AR";
GRANT MONITOR ON WAREHOUSE "QA_COMPUTE_WH" TO ROLE "QA_COMPUTE_WH_UM_AR";

-- Grant Access Roles to Functional Roles
USE ROLE SECURITYADMIN;
GRANT ROLE "QA_EDW_DB_MODEL_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_EDW_DB_RAW_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_EDW_DB_STAGE_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_COMPUTE_WH_FULL_AR" TO ROLE "QA_ADMIN_FR";
GRANT ROLE "QA_EDW_DB_MODEL_R_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_EDW_DB_RAW_R_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_EDW_DB_STAGE_R_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_COMPUTE_WH_U_AR" TO ROLE "QA_ANALYST_FR";
GRANT ROLE "QA_EDW_DB_MODEL_RW_AR" TO ROLE "QA_ENGINEER_FR";
GRANT ROLE "QA_EDW_DB_RAW_RW_AR" TO ROLE "QA_ENGINEER_FR";
GRANT ROLE "QA_EDW_DB_STAGE_RW_AR" TO ROLE "QA_ENGINEER_FR";
GRANT ROLE "QA_COMPUTE_WH_UM_AR" TO ROLE "QA_ENGINEER_FR";


/*

END ROLEOUT-GENERATED RBAC

*/

/*

RBAC SECTION 2: SANDBOX

Includes:
I)   The definitions of the read, Read-Write, and Full Access Roles for SANDBOX
II)  The grants that coalesce all these various access roles into the only functional 
     role for Sandbox -- SANDBOX_ENGINEER_FR

The privileges for the Sandbox Env will all be at the Database level, at least initially. 
This is because (again, initially), there will be  no "native" schema in  the Sandbox. What 
schema do exist in the Sandbox will (usually) be created with theClone-to-Sandbox sproc, 
and RBAC for those newly-created schemas is generated on-the-fly within that sproc itself.

*/


-- Create and Grant Privileges to Access Role SANDBOX_EDW_DB_FULL_AR
USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "SANDBOX_EDW_DB_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT USAGE ON DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OWNERSHIP ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR" COPY CURRENT GRANTS;
GRANT OWNERSHIP ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE SEQUENCES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT READ ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT READ ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE FILE FORMATS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE STREAMS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE PROCEDURES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON ALL FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT USAGE ON FUTURE FUNCTIONS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON ALL MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT SELECT ON FUTURE MATERIALIZED VIEWS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT INSERT ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT UPDATE ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT DELETE ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT REFERENCES ON ALL TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT INSERT ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT UPDATE ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT DELETE ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT REFERENCES ON FUTURE TABLES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT WRITE ON FUTURE STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT WRITE ON ALL STAGES IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT MONITOR ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OPERATE ON ALL TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT MONITOR ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";
GRANT OPERATE ON FUTURE TASKS IN DATABASE "SANDBOX_EDW_DB" TO ROLE "SANDBOX_EDW_DB_FULL_AR";

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS "SANDBOX_COMPUTE_WH_FULL_AR";
USE ROLE SECURITYADMIN;
GRANT OWNERSHIP ON WAREHOUSE "SANDBOX_COMPUTE_WH" TO ROLE "SANDBOX_COMPUTE_WH_FULL_AR";

USE ROLE USERADMIN;
CREATE ROLE IF NOT EXISTS SANDBOX_ENGINEER_FR;
USE ROLE SECURITYADMIN;
GRANT ROLE SANDBOX_EDW_DB_FULL_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE SANDBOX_COMPUTE_WH_FULL_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE SANDBOX_ENGINEER_FR TO ROLE SANDBOX_SYSADMIN;


/*
RBAC SECTION 3: READ-UPS

Includes:
I)   Additional grants for "Read-ups" required between environments


Roleout's Default behavior is to isolate each of the envs-- as in the QA roles can't interact at all with the Dev objects, 
the Dev roles can't at all interact with the Prod objects, etc.

This is not usually what we want in practice. Instead, we want to support "read-ups". That is, for any given environment,
the roles for that Env should have read-only access to the higher envs, their entitled access to the role's dedicated
env, and no access to lower envs.

For example, the DEV_ENGINEER_FR role should have

1. Zero access to Sandbox
2. Read/write access to Dev
3. Read-only access to QA
4. Read-only access to Prod

*/

USE ROLE SECURITYADMIN;

-- Allow "read ups" from Sandbox Engineer & Admin to Dev
GRANT ROLE DEV_EDW_DB_RAW_R_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE DEV_EDW_DB_STAGE_R_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE DEV_EDW_DB_MODEL_R_AR TO ROLE SANDBOX_ENGINEER_FR;

-- ...from Sandbox to QA
GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE SANDBOX_ENGINEER_FR;

-- ...from Sandbox to Prod
GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE SANDBOX_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE SANDBOX_ENGINEER_FR;


-- Allow "read ups" from Dev Analyst, Engineer, Admin to QA
GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE DEV_ANALYST_FR;

GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE DEV_ENGINEER_FR;

GRANT ROLE QA_EDW_DB_RAW_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE QA_EDW_DB_STAGE_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE QA_EDW_DB_MODEL_R_AR TO ROLE DEV_ADMIN_FR;


-- Allow "read ups" from Dev Analyst, Engineer, Admin to Prod
GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE DEV_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE DEV_ANALYST_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE DEV_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE DEV_ENGINEER_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE DEV_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE DEV_ADMIN_FR;


-- Allow "read ups" from QA Analyst, Engineer, Admin to Prod
GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE QA_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE QA_ANALYST_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE QA_ANALYST_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE QA_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE QA_ENGINEER_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE QA_ENGINEER_FR;

GRANT ROLE PROD_EDW_DB_RAW_R_AR TO ROLE QA_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_STAGE_R_AR TO ROLE QA_ADMIN_FR;
GRANT ROLE PROD_EDW_DB_MODEL_R_AR TO ROLE QA_ADMIN_FR;


/*

RBAC SECTION 4: "Utilities" Database and other needed RBAC
LAST EDITED 2025-02-24 14:36 -0500

This database will contain objects meant to support quality-of-life features like
easy copying from env to env and bundling complex RBAC setup into one-command sprocs.
None of the objects in this database will be specific to any data layer or any business
related entity.

Calling this "SHERLOCK_WINGS" for now since that's my name and I don't have a better idea
for a specific name at the moment. On a real project, we'd probably just name this db after 
the company who the project is for or something. 

I am not 100% sure what kind of RBAC is appropriate here. However, I know I want the 
clone-to-sandbox sproc to live here. That sproc has to execute GRANT statements on the fly.
The proper role to be doing GRANTs is SECURITYADMIN. So while the owner of this DB will be 
SYSADMIN, SECURITYADMIN will have CREATE PROCEDURE and some other privs in here so I can 
support the privs I need for that sproc. 

*/
USE ROLE SECURITYADMIN;
grant usage on database sherlock_wings to role securityadmin;
grant usage on schema sherlock_wings.util to role securityadmin;
grant create procedure on schema sherlock_wings.util to role securityadmin;

/*
Because SECURITYADMIN will be invoked when this clone-to-sandbox sproc is called, and 
because that sproc will be running CREATE.. CLONE and GRANT.. statements agaihst any/all envs,
we need to give SECURITYADMIN read-only rights in all envs.
*/
USE ROLE SECURITYADMIN;
grant role dev_analyst_fr to role securityadmin;
grant role qa_analyst_fr to role securityadmin;
grant role prod_analyst_fr to role securityadmin;
